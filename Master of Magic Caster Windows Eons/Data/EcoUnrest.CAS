: INPUT CITYID - the city to calculate
		TAXPERC - percentage of unrest caused by the tax rate
		RACEUN - racial unrest level applied (races.ini)
  OUTPUT UNREST - the total number of rebels :

UNPERC=TAXPERC;
UNPERC=UNPERC+(RACEUN*10)
UNREST = %I ((POPUNITS(CITYID) * UNPERC ) /100)
REL=0;
IF CITYENCHANT(CITYID,CEEvilPresence)=-1 THEN {
IF ISBUILT(CITYID,BShrine) THEN { REL=REL+1; }
IF ISBUILT(CITYID,BTemple) THEN { REL=REL+1; }
IF ISBUILT(CITYID,BCathedral) THEN { 
REL=REL+1;
IF ISBUILT(CITYID,BAlchemistGuild) THEN { REL=REL+%I((OREINRANGE(CITYID,OreNightshade)/2)); }
};
}

W=CITYOWNER(CITYID);
IF RETORT(W,CultLeader) THEN { REL=REL+(%I (REL/2)); }

RED=REL;
IF ISBUILT(CITYID,BColosseum) THEN { RED=RED+1; }

NOFGEDDON=0;
NOFDOOMS=0;

FOR I=0 TO NOFWIZARDS();
IF %N (I=W) THEN {
IF HASGLOBAL(I,GEArmageddon) THEN { NOFGEDDON=NOFGEDDON+1; }
IF HASGLOBAL(I,GEDoomsday) THEN { NOFDOOMS=NOFDOOMS+1; }
}
NEXT;

IF NOFGEDDON>0 THEN { RED=(RED-1)-NOFGEDDON; }
If NOFDOOMS>0 THEN { RED=(RED-3)-(2*NOFDOOMS); }

IF CITYENCHANT(CITYID,CEDarkRituals)>-1 THEN { RED=RED-1; }
IF CITYENCHANT(CITYID,CEPestilence)>-1 THEN { RED=RED-2; }

If HASGLOBAL(W,GEJustCause) THEN {RED=RED+1; }

IF CITYENCHANT(CITYID,CEGaiasBlessing)>-1 THEN { RED=RED+2; }
IF CITYENCHANT(CITYID,CEStreamofLife)>-1 THEN { RED=RED+3; }

UNREST = UNREST - RED;

UNREST = UNREST - (%I(GARRISON(CITYID)/2));
